<!DOCTYPE html>
<html>
<head>
    <title>Demo App</title>
</head>
<body>
<script ka:scope="global">
    // Store request state
    _.appName = 'Demo App'
    _.isGet = request.get
    _.isPost = request.post
    _.isAjax = request.ajax
    _.uuid = context.uuid()
    _.sessionId = context.sessionId || 'none'
    _.templateName = context.template
    _.hasSession = typeof session !== 'undefined' && session != null
    _.visitCount = _.hasSession ? (session.visitCount || 0) + 1 : 1
    if (_.hasSession) {
        session.visitCount = _.visitCount
    }
</script>

<div th:replace="header.html"></div>

<main>
    <h1 th:text="_.appName">App Name</h1>
    <p>Visit count: <span th:text="_.visitCount">0</span></p>
    <p>Session ID: <span th:text="_.sessionId">none</span></p>
    <p>Template: <span th:text="_.templateName">unknown</span></p>

    <!-- Request method detection -->
    <div th:if="_.isGet" id="method-get">This is a GET request</div>
    <div th:if="_.isPost" id="method-post">This is a POST request</div>

    <!-- AJAX detection -->
    <div th:if="_.isAjax" id="ajax-request">This is an AJAX request</div>
    <div th:unless="_.isAjax" id="full-request">This is a full page request</div>

    <!-- UUID generation -->
    <div id="uuid" th:text="_.uuid">uuid here</div>

    <!-- Links -->
    <nav>
        <a href="/items">View Items</a>
        <a href="/form">Submit Form</a>
    </nav>
</main>
</body>
</html>
